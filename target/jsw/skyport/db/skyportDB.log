/*C4*/SET SCHEMA PUBLIC
DISCONNECT
/*C6*/SET SCHEMA PUBLIC
alter table ORGANIZATIONS drop constraint FK3C16D1806B75CDDC
alter table PERMISSION_OPERATION drop constraint FK2C46DAD7D03275B9
alter table ROLES drop constraint FK4A8969DEE28B425
alter table ROLES drop constraint FK4A8969DA4A37FDF
alter table ROLE_PERMISSION drop constraint FK9C6EC938B8F27D9E
alter table ROLE_PERMISSION drop constraint FK9C6EC938DAF7B9EB
alter table SESSION drop constraint FKA11C0E76E04D0F55
alter table TASKEVENT drop constraint FKB135F815E04D0F55
alter table TASKEVENTLOG drop constraint FK3771BAEF32378666
alter table USERS drop constraint FK4D495E8EE28B425
alter table USER_ROLE drop constraint FKBC16F46ADAF7B9EB
alter table USER_ROLE drop constraint FKBC16F46AE04D0F55
drop table ORGANIZATIONS if exists
drop table PERMISSION_OPERATION if exists
drop table ROLES if exists
drop table ROLE_PERMISSION if exists
drop table SCOPE if exists
drop table SESSION if exists
drop table TASKEVENT if exists
drop table TASKEVENTLOG if exists
drop table USERS if exists
drop table USER_ROLE if exists
create table ORGANIZATIONS (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(150), OPTLOCK integer, ENABLE boolean, NAME varchar(40), PARENTID bigint, primary key (ID))
create table PERMISSION_OPERATION (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(150), OPTLOCK integer, ALIAS varchar(256), PARENTID bigint, primary key (ID))
create table ROLES (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(150), OPTLOCK integer, ENABLE boolean, NAME varchar(40), ORGANIZATIONID bigint, SCOPEID bigint, primary key (ID))
create table ROLE_PERMISSION (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(256), PERMISSIONID bigint, ROLEID bigint, primary key (ID))
create table SCOPE (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(150), OPTLOCK integer, ALIAS varchar(40), NAME varchar(40), primary key (ID))
create table SESSION (ID bigint generated by default as identity (start with 1), BROWSER varchar(20), CDATE timestamp, DDATE timestamp, DESCRIPTION varchar(256), ENABLE boolean, IP varchar(40), NAME varchar(40), TOKEN varchar(60), USERID bigint, primary key (ID))
create table TASKEVENT (ID bigint generated by default as identity (start with 1), CMD varchar(80), CONFIG varchar(40), PARA varchar(256), REGISTERDATE timestamp, OPTLOCK integer, USERID bigint, primary key (ID))
create table TASKEVENTLOG (ID bigint generated by default as identity (start with 1), DETAIL blob(65535), LOGDATE timestamp, MESSAGE varchar(500), STATUS integer, OPTLOCK integer, EVENTID bigint, primary key (ID))
create table USERS (ID bigint generated by default as identity (start with 1), DESCRIPTION varchar(150), OPTLOCK integer, ENABLE boolean, KEY varchar(100), LASTLOGIN timestamp, LOGINNAME varchar(40), NAME varchar(40), PASSWORD varchar(100), SALT varchar(100), SECRET varchar(100), ORGANIZATIONID bigint, primary key (ID))
create table USER_ROLE (ID bigint generated by default as identity (start with 1), ROLEID bigint, USERID bigint, primary key (ID))
alter table ORGANIZATIONS add constraint FK3C16D1806B75CDDC foreign key (PARENTID) references ORGANIZATIONS
alter table PERMISSION_OPERATION add constraint FK2C46DAD7D03275B9 foreign key (PARENTID) references PERMISSION_OPERATION
alter table ROLES add constraint FK4A8969DEE28B425 foreign key (ORGANIZATIONID) references ORGANIZATIONS
alter table ROLES add constraint FK4A8969DA4A37FDF foreign key (SCOPEID) references SCOPE
alter table ROLE_PERMISSION add constraint FK9C6EC938B8F27D9E foreign key (PERMISSIONID) references PERMISSION_OPERATION
alter table ROLE_PERMISSION add constraint FK9C6EC938DAF7B9EB foreign key (ROLEID) references ROLES
alter table SESSION add constraint FKA11C0E76E04D0F55 foreign key (USERID) references USERS
alter table TASKEVENT add constraint FKB135F815E04D0F55 foreign key (USERID) references USERS
alter table TASKEVENTLOG add constraint FK3771BAEF32378666 foreign key (EVENTID) references TASKEVENT
alter table USERS add constraint FK4D495E8EE28B425 foreign key (ORGANIZATIONID) references ORGANIZATIONS
alter table USER_ROLE add constraint FKBC16F46ADAF7B9EB foreign key (ROLEID) references ROLES
alter table USER_ROLE add constraint FKBC16F46AE04D0F55 foreign key (USERID) references USERS
INSERT INTO PERMISSION_OPERATION VALUES(1,'*:*',0,'System',NULL)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(15,'vm:*',0,'Vm',1)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(16,'pool:*',0,'Pool',1)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(17,'user:*',0,'User',1)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(2,'vm:create',0,'Create',15)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(3,'vm:update',0,'Update',15)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(4,'vm:delete',0,'Delete',15)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(5,'pool:create',0,'Create',16)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(6,'pool:pdate',0,'Update',16)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(7,'pool:delete',0,'Delete',16)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(8,'user:create',0,'Create',17)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(9,'user:update',0,'Update',17)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(10,'user:delete',0,'Delete',17)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(11,'vm:Query',0,'Query',15)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(12,'pool:query',0,'Query',16)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(13,'user:Query',0,'Query',17)
COMMIT
INSERT INTO PERMISSION_OPERATION VALUES(14,'vm:operate',0,'Operate',15)
COMMIT
INSERT INTO SCOPE VALUES(1,'private',0,'private','private')
COMMIT
INSERT INTO SCOPE VALUES(2,'group',0,'group','group')
COMMIT
INSERT INTO SCOPE VALUES(3,'*',0,'department','dep')
COMMIT
INSERT INTO ORGANIZATIONS VALUES(1,'system',0,TRUE,'System',NULL)
COMMIT
INSERT INTO ROLES VALUES(1,'System Manager',0,TRUE,'SystemAdmin',1,3)
COMMIT
INSERT INTO ROLE_PERMISSION VALUES(1,NULL,1,1)
COMMIT
INSERT INTO USERS VALUES(1,'System Administrator',0,TRUE,'GpRJi6lW1OcKbEAh9UdvRA==',NULL,'admin','Administrator','6b8cb26ca1e72b301e3c7ab221f5f07e29f8e86f9a03f52b62bf5973e1dd94e0','aSnGQpQoRD31+KEwdmUWdA==','WA4y1YUuf1JGvBZbgQBzz6jArwCvM2WLCP7Atqkvx0Q=',1)
COMMIT
INSERT INTO USER_ROLE VALUES(1,1,1)
COMMIT
